{"version":3,"sources":["buttons/ZoomButton.js"],"names":["define","PSVNavBarButton","PSVNavBarZoomButton","navbar","call","this","zoom_range","zoom_value","prop","mousedown","buttondown","longPressInterval","longPressTimeout","create","prototype","Object","constructor","id","className","zoom_minus","document","createElement","title","psv","config","lang","zoomOut","_setIcon","container","appendChild","zoom_range_bg","zoom_plus","zoomIn","addEventListener","_zoomOut","bind","_zoomIn","on","one","_moveZoomValue","zoom_lvl","destroy","_stopZoomChange","removeEventListener","off","handleEvent","e","type","_initZoomChangeWithMouse","_initZoomChangeByTouch","_changeZoomWithMouse","_changeZoomByTouch","args","level","style","left","offsetWidth","evt","enabled","_changeZoom","clientX","changedTouches","window","setTimeout","_startLongPressInterval","value","setInterval","zoom","clearInterval","clearTimeout","preventDefault","x","zoom_level","parseInt","getBoundingClientRect"],"mappings":"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","file":"../../buttons/ZoomButton.js","sourcesContent":["define([\n  \"./Button\"\n],function(PSVNavBarButton){\n  \"use strict\";\n  /**\n   * Navigation bar zoom button class\n   * @param {module:components.PSVNavBar} navbar\n   * @constructor\n   * @extends module:components/buttons.PSVNavBarButton\n   * @memberof module:components/buttons\n   */\n  function PSVNavBarZoomButton(navbar) {\n    PSVNavBarButton.call(this, navbar);\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.zoom_range = null;\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.zoom_value = null;\n\n    /**\n     * @member {Object}\n     * @private\n     */\n    this.prop = {\n      mousedown: false,\n      buttondown: false,\n      longPressInterval: null,\n      longPressTimeout: null\n    };\n\n    this.create();\n  }\n\n  PSVNavBarZoomButton.prototype = Object.create(PSVNavBarButton.prototype);\n  PSVNavBarZoomButton.prototype.constructor = PSVNavBarZoomButton;\n\n  PSVNavBarZoomButton.id = 'zoom';\n  PSVNavBarZoomButton.className = 'psv-button psv-zoom-button';\n\n  /**\n   * @override\n   */\n  PSVNavBarZoomButton.prototype.create = function() {\n    PSVNavBarButton.prototype.create.call(this);\n\n    var zoom_minus = document.createElement('div');\n    zoom_minus.className = 'psv-zoom-button-minus';\n    zoom_minus.title = this.psv.config.lang.zoomOut;\n    this._setIcon('zoom-out.svg', zoom_minus);\n    this.container.appendChild(zoom_minus);\n\n    var zoom_range_bg = document.createElement('div');\n    zoom_range_bg.className = 'psv-zoom-button-range';\n    this.container.appendChild(zoom_range_bg);\n\n    this.zoom_range = document.createElement('div');\n    this.zoom_range.className = 'psv-zoom-button-line';\n    zoom_range_bg.appendChild(this.zoom_range);\n\n    this.zoom_value = document.createElement('div');\n    this.zoom_value.className = 'psv-zoom-button-handle';\n    this.zoom_range.appendChild(this.zoom_value);\n\n    var zoom_plus = document.createElement('div');\n    zoom_plus.className = 'psv-zoom-button-plus';\n    zoom_plus.title = this.psv.config.lang.zoomIn;\n    this._setIcon('zoom-in.svg', zoom_plus);\n    this.container.appendChild(zoom_plus);\n\n    this.zoom_range.addEventListener('mousedown', this);\n    this.zoom_range.addEventListener('touchstart', this);\n    this.psv.container.addEventListener('mousemove', this);\n    this.psv.container.addEventListener('touchmove', this);\n    this.psv.container.addEventListener('mouseup', this);\n    this.psv.container.addEventListener('touchend', this);\n    zoom_minus.addEventListener('mousedown', this._zoomOut.bind(this));\n    zoom_plus.addEventListener('mousedown', this._zoomIn.bind(this));\n\n    this.psv.on('zoom-updated', this);\n\n    this.psv.one('ready', function() {\n      this._moveZoomValue(this.psv.prop.zoom_lvl);\n    }.bind(this));\n  };\n\n  /**\n   * @override\n   */\n  PSVNavBarZoomButton.prototype.destroy = function() {\n    this._stopZoomChange();\n\n    this.psv.container.removeEventListener('mousemove', this);\n    this.psv.container.removeEventListener('touchmove', this);\n    this.psv.container.removeEventListener('mouseup', this);\n    this.psv.container.removeEventListener('touchend', this);\n\n    delete this.zoom_range;\n    delete this.zoom_value;\n\n    this.psv.off('zoom-updated', this);\n\n    PSVNavBarButton.prototype.destroy.call(this);\n  };\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  PSVNavBarZoomButton.prototype.handleEvent = function(e) {\n    switch (e.type) {\n      // @formatter:off\n      case 'mousedown':     this._initZoomChangeWithMouse(e); break;\n      case 'touchstart':    this._initZoomChangeByTouch(e); break;\n      case 'mousemove':     this._changeZoomWithMouse(e); break;\n      case 'touchmove':     this._changeZoomByTouch(e); break;\n      case 'mouseup':       this._stopZoomChange(e); break;\n      case 'touchend':      this._stopZoomChange(e); break;\n      case 'zoom-updated':  this._moveZoomValue(e.args[0]); break;\n      // @formatter:on\n    }\n  };\n\n  /**\n   * @summary Moves the zoom cursor\n   * @param {int} level\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._moveZoomValue = function(level) {\n    this.zoom_value.style.left = (level / 100 * this.zoom_range.offsetWidth - this.zoom_value.offsetWidth / 2) + 'px';\n  };\n\n  /**\n   * @summary Handles mouse down events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._initZoomChangeWithMouse = function(evt) {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.prop.mousedown = true;\n    this._changeZoom(evt.clientX);\n  };\n\n  /**\n   * @summary Handles touch events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._initZoomChangeByTouch = function(evt) {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.prop.mousedown = true;\n    this._changeZoom(evt.changedTouches[0].clientX);\n  };\n\n  /**\n   * @summary Handles click events\n   * @description Zooms in and register long press timer\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._zoomIn = function() {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.prop.buttondown = true;\n    this.psv.zoomIn();\n    this.prop.longPressTimeout = window.setTimeout(this._startLongPressInterval.bind(this, 1), 200);\n  };\n\n  /**\n   * @summary Handles click events\n   * @description Zooms out and register long press timer\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._zoomOut = function() {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.prop.buttondown = true;\n    this.psv.zoomOut();\n    this.prop.longPressTimeout = window.setTimeout(this._startLongPressInterval.bind(this, -1), 200);\n  };\n\n  /**\n   * @summary Continues zooming as long as the user presses the button\n   * @param value\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._startLongPressInterval = function(value) {\n    if (this.prop.buttondown) {\n      this.prop.longPressInterval = window.setInterval(function() {\n        this.psv.zoom(this.psv.prop.zoom_lvl + value);\n      }.bind(this), 50);\n    }\n  };\n\n  /**\n   * @summary Handles mouse up events\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._stopZoomChange = function() {\n    if (!this.enabled) {\n      return;\n    }\n\n    window.clearInterval(this.prop.longPressInterval);\n    window.clearTimeout(this.prop.longPressTimeout);\n    this.prop.longPressInterval = null;\n    this.prop.mousedown = false;\n    this.prop.buttondown = false;\n  };\n\n  /**\n   * @summary Handles mouse move events\n   * @param {MouseEvent} evt\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._changeZoomWithMouse = function(evt) {\n    if (!this.enabled) {\n      return;\n    }\n\n    evt.preventDefault();\n    this._changeZoom(evt.clientX);\n  };\n\n  /**\n   * @summary Handles touch move events\n   * @param {TouchEvent} evt\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._changeZoomByTouch = function(evt) {\n    if (!this.enabled) {\n      return;\n    }\n    this._changeZoom(evt.changedTouches[0].clientX);\n  };\n\n  /**\n   * @summary Zoom change\n   * @param {int} x - mouse/touch position\n   * @private\n   */\n  PSVNavBarZoomButton.prototype._changeZoom = function(x) {\n    if (this.prop.mousedown) {\n      var user_input = parseInt(x) - this.zoom_range.getBoundingClientRect().left;\n      var zoom_level = user_input / this.zoom_range.offsetWidth * 100;\n      this.psv.zoom(zoom_level);\n    }\n  };\n\n  return PSVNavBarZoomButton;\n\n});\n\n"]}