/**
 * skylark-sphere - A version of sphere that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-sphere/
 * @license MIT
 */
define(["skylark-langx-types","skylark-langx-objects","skylark-langx-strings","skylark-langx-funcs","skylark-domx-noder","skylark-domx-styler","skylark-domx-finder","skylark-devices-points/mouse","skylark-devices-points/touch","skylark-devices-orientation","skylark-devices-webgl","skylark-threejs","skylark-threejs-ex/controls/DeviceOrientationControls","skylark-threejs-ex/effects/StereoEffect","./_psv/ctoc"],function(e,t,n,r,a,s,o,l,i,c,u,d,m,p,h){"use strict";d.DeviceOrientationControls=m,d.StereoEffect=p;var f={};return h.Utils=f,f.TwoPI=2*Math.PI,f.HalfPI=Math.PI/2,f.svgNS="http://www.w3.org/2000/svg",f.checkTHREE=function(e){for(var t=0,n=arguments.length;t<n;t++)if(!(arguments[t]in d))return!1;return!0},f.isCanvasSupported=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},f.getWebGLCtx=u.getWebGLCtx,f.isWebGLSupported=u.isWebGLSupported,f.isDeviceOrientationSupported=c.isDeviceOrientationSupported,f.isTouchEnabled=i.isTouchEnabled,f.getMaxTextureWidth=u.getMaxTextureWidth,f.toggleClass=s.toggleClass,f.addClasses=s.addClass,f.removeClasses=s.removeClass,f.hasParent=a.isChildOf,f.getClosest=o.closest,f.mouseWheelEvent=l.mouseWheelEvent,f.getEventKey=function(e){var t=e.key||f.getEventKey.KEYMAP[e.keyCode||e.which];return t&&f.getEventKey.MS_KEYMAP[t]&&(t=f.getEventKey.MS_KEYMAP[t]),t},f.getEventKey.KEYMAP={13:"Enter",27:"Escape",32:" ",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete",107:"+",109:"-"},f.getEventKey.MS_KEYMAP={Add:"+",Del:"Delete",Down:"ArrowDown",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Subtract:"-",Up:"ArrowUp"},f.fullscreenEvent=function(){var e={exitFullscreen:"fullscreenchange",webkitExitFullscreen:"webkitfullscreenchange",mozCancelFullScreen:"mozfullscreenchange",msExitFullscreen:"MSFullscreenChange"};for(var t in e)if(e.hasOwnProperty(t)&&t in document)return e[t];return null},f.bound=function(e,t,n){return Math.max(t,Math.min(n,e))},f.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},f.sum=function(e){return e.reduce(function(e,t){return e+t},0)},f.dasherize=n.dasherize,f.getXMPValue=function(e,t){var n;return null!==(n=e.match("<GPano:"+t+">(.*)</GPano:"+t+">"))?n[1]:null!==(n=e.match("GPano:"+t+'="(.*?)"'))?n[1]:null},f.isFullscreenEnabled=function(e){return(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)===e},f.requestFullscreen=function(e){(e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen).call(e)},f.exitFullscreen=function(){(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document)},f.getStyle=s.css,f.getShortestArc=function(e,t){return[0,f.TwoPI,-f.TwoPI].reduce(function(n,r){return r=t-e+r,Math.abs(r)<Math.abs(n)?r:n},1/0)},f.getAngle=function(e,t){return Math.acos(Math.cos(e.latitude)*Math.cos(t.latitude)*Math.cos(e.longitude-t.longitude)+Math.sin(e.latitude)*Math.sin(t.latitude))},f.parsePosition=function(e){if(!e)return{top:.5,left:.5};if("object"==typeof e)return e;var t=e.toLocaleLowerCase().split(" ").slice(0,2);1===t.length&&(t=void 0!==f.parsePosition.positions[t[0]]?[t[0],"center"]:[t[0],t[0]]);var n="left"!==t[1]&&"right"!==t[1]&&"top"!==t[0]&&"bottom"!==t[0];t=t.map(function(e){return f.parsePosition.positions[e]||e}),n||t.reverse();var r=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{left:r[1]/100,top:r[2]/100}:{top:.5,left:.5}},f.parsePosition.positions={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},f.parseSpeed=function(e){if("string"==typeof e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(n.match(/(pm|per minute)$/)&&(t/=60),n){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=d.Math.degToRad(t);break;case"radians per minute":case"radians per second":e=t;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=t*f.TwoPI;break;default:throw new PSVError('unknown speed unit "'+n+'"')}}return e},f.parseAngle=function(e,t,n){if(void 0===n&&(n=t),"string"==typeof e){var r=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!r)throw new PSVError('unknown angle "'+e+'"');var a=parseFloat(r[1]),s=r[2];if(s)switch(s){case"deg":case"degs":e=d.Math.degToRad(a);break;case"rad":case"rads":e=a;break;default:throw new PSVError('unknown angle unit "'+s+'"')}else e=a}return(e=(t?e+Math.PI:e)%f.TwoPI)<0&&(e=f.TwoPI+e),t?f.bound(e-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):e},f.cleanTHREEScene=function(e){e.children.forEach(function(e){e instanceof d.Mesh&&(e.geometry&&(e.geometry.dispose(),e.geometry=null),e.material&&(e.material.materials?(e.material.materials.forEach(function(e){e.map&&(e.map.dispose(),e.map=null),e.dispose()}),e.material.materials.length=0):(e.material.map&&(e.material.map.dispose(),e.material.map=null),e.material.dispose()),e.material=null))}),e.children.length=0},f.throttle=r.debounce,f.isPlainObject=e.isPlainObject,f.deepmerge=function(e,n){return t.mixin(e,n,!0)},f.clone=t.clone,f.normalizeWheel=l.normalizeWheel,f.forEach=function(e,n){return t.each(e,n,!0)},f});
//# sourceMappingURL=sourcemaps/PSVUtils.js.map
