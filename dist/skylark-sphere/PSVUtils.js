/**
 * skylark-sphere - A version of sphere that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-sphere/
 * @license MIT
 */
define(["skylark-threejs","skylark-threejs-ex/controls/DeviceOrientationControls","skylark-threejs-ex/effects/StereoEffect","./_psv/ctoc"],function(e,t,n,r){"use strict";e.DeviceOrientationControls=t,e.StereoEffect=n;var o={};return r.Utils=o,o.TwoPI=2*Math.PI,o.HalfPI=Math.PI/2,o.svgNS="http://www.w3.org/2000/svg",o.checkTHREE=function(t){for(var n=0,r=arguments.length;n<r;n++)if(!(arguments[n]in e))return!1;return!0},o.isCanvasSupported=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},o.getWebGLCtx=function(){var e=document.createElement("canvas"),t=null;return e.getContext&&["webgl","experimental-webgl","moz-webgl","webkit-3d"].some(function(n){try{return(t=e.getContext(n))&&"function"==typeof t.getParameter}catch(e){return!1}})?t:null},o.isWebGLSupported=function(){return!!window.WebGLRenderingContext&&null!==o.getWebGLCtx()},o.isDeviceOrientationSupported=function(){return new Promise(function(e){if("DeviceOrientationEvent"in window){var t=function(n){n&&null!==n.alpha&&!isNaN(n.alpha)?e(!0):e(!1),window.removeEventListener("deviceorientation",t)};window.addEventListener("deviceorientation",t,!1),setTimeout(t,2e3)}else e(!1)})},o.isTouchEnabled=function(){return new Promise(function(e){var t=function(n){e(!!n),window.removeEventListener("touchstart",t)};window.addEventListener("touchstart",t,!1),setTimeout(t,1e4)})},o.getMaxTextureWidth=function(){var e=o.getWebGLCtx();return null!==e?e.getParameter(e.MAX_TEXTURE_SIZE):0},o.toggleClass=function(e,t,n){if(e.classList)void 0===n?e.classList.toggle(t):n&&!e.classList.contains(t)?e.classList.add(t):n||e.classList.remove(t);else{var r=e.getAttribute("class")||"",o=-1!==r.indexOf(t),a=new RegExp("(?:^|\\s)"+t+"(?:\\s|$)");void 0!==n&&!n||o?n||(r=r.replace(a," ")):r+=r.length>0?" "+t:t,e.setAttribute("class",r)}},o.addClasses=function(e,t){t&&t.split(" ").forEach(function(t){o.toggleClass(e,t,!0)})},o.removeClasses=function(e,t){t&&t.split(" ").forEach(function(t){o.toggleClass(e,t,!1)})},o.hasParent=function(e,t){do{if(e===t)return!0}while(e=e.parentNode);return!1},o.getClosest=function(e,t){var n=e.matches||e.msMatchesSelector;do{if(n.bind(e)(t))return e}while(e=e instanceof SVGElement?e.parentNode:e.parentElement);return null},o.mouseWheelEvent=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},o.getEventKey=function(e){var t=e.key||o.getEventKey.KEYMAP[e.keyCode||e.which];return t&&o.getEventKey.MS_KEYMAP[t]&&(t=o.getEventKey.MS_KEYMAP[t]),t},o.getEventKey.KEYMAP={13:"Enter",27:"Escape",32:" ",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete",107:"+",109:"-"},o.getEventKey.MS_KEYMAP={Add:"+",Del:"Delete",Down:"ArrowDown",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Subtract:"-",Up:"ArrowUp"},o.fullscreenEvent=function(){var e={exitFullscreen:"fullscreenchange",webkitExitFullscreen:"webkitfullscreenchange",mozCancelFullScreen:"mozfullscreenchange",msExitFullscreen:"MSFullscreenChange"};for(var t in e)if(e.hasOwnProperty(t)&&t in document)return e[t];return null},o.bound=function(e,t,n){return Math.max(t,Math.min(n,e))},o.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},o.sum=function(e){return e.reduce(function(e,t){return e+t},0)},o.dasherize=function(e){return e.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,function(e,t){return(t>0?"-":"")+e.toLowerCase()})},o.getXMPValue=function(e,t){var n;return null!==(n=e.match("<GPano:"+t+">(.*)</GPano:"+t+">"))?n[1]:null!==(n=e.match("GPano:"+t+'="(.*?)"'))?n[1]:null},o.isFullscreenEnabled=function(e){return(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)===e},o.requestFullscreen=function(e){(e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen).call(e)},o.exitFullscreen=function(){(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document)},o.getStyle=function(e,t){return window.getComputedStyle(e,null)[t]},o.getShortestArc=function(e,t){return[0,o.TwoPI,-o.TwoPI].reduce(function(n,r){return r=t-e+r,Math.abs(r)<Math.abs(n)?r:n},1/0)},o.getAngle=function(e,t){return Math.acos(Math.cos(e.latitude)*Math.cos(t.latitude)*Math.cos(e.longitude-t.longitude)+Math.sin(e.latitude)*Math.sin(t.latitude))},o.parsePosition=function(e){if(!e)return{top:.5,left:.5};if("object"==typeof e)return e;var t=e.toLocaleLowerCase().split(" ").slice(0,2);1===t.length&&(t=void 0!==o.parsePosition.positions[t[0]]?[t[0],"center"]:[t[0],t[0]]);var n="left"!==t[1]&&"right"!==t[1]&&"top"!==t[0]&&"bottom"!==t[0];t=t.map(function(e){return o.parsePosition.positions[e]||e}),n||t.reverse();var r=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{left:r[1]/100,top:r[2]/100}:{top:.5,left:.5}},o.parsePosition.positions={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},o.parseSpeed=function(t){if("string"==typeof t){t=t.toString().trim();var n=parseFloat(t.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),r=t.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(n/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=e.Math.degToRad(n);break;case"radians per minute":case"radians per second":t=n;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=n*o.TwoPI;break;default:throw new PSVError('unknown speed unit "'+r+'"')}}return t},o.parseAngle=function(t,n,r){if(void 0===r&&(r=n),"string"==typeof t){var a=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!a)throw new PSVError('unknown angle "'+t+'"');var i=parseFloat(a[1]),l=a[2];if(l)switch(l){case"deg":case"degs":t=e.Math.degToRad(i);break;case"rad":case"rads":t=i;break;default:throw new PSVError('unknown angle unit "'+l+'"')}else t=i}return(t=(n?t+Math.PI:t)%o.TwoPI)<0&&(t=o.TwoPI+t),n?o.bound(t-Math.PI,-Math.PI/(r?2:1),Math.PI/(r?2:1)):t},o.cleanTHREEScene=function(t){t.children.forEach(function(t){t instanceof e.Mesh&&(t.geometry&&(t.geometry.dispose(),t.geometry=null),t.material&&(t.material.materials?(t.material.materials.forEach(function(e){e.map&&(e.map.dispose(),e.map=null),e.dispose()}),t.material.materials.length=0):(t.material.map&&(t.material.map.dispose(),t.material.map=null),t.material.dispose()),t.material=null))}),t.children.length=0},o.throttle=function(e,t){var n,r,o,a=null,i=0,l=function(){i=Date.now(),a=null,o=e.apply(n,r),a||(n=r=null)};return function(){var s=Date.now();i||(i=s);var u=t-(s-i);return n=this,r=arguments,u<=0||u>t?(a&&(clearTimeout(a),a=null),i=s,o=e.apply(n,r),a||(n=r=null)):a||(a=setTimeout(l,u)),o}},o.isPlainObject=function(e){if("object"==typeof e&&null!==e){if("function"==typeof Object.getPrototypeOf){var t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}return"[object Object]"===Object.prototype.toString.call(e)}return!1},o.deepmerge=function(e,t){var n=t;return function e(t,r){return Array.isArray(r)?(t&&Array.isArray(t)?t.length=0:t=[],r.forEach(function(n,r){t[r]=e(null,n)})):"object"==typeof r?(t&&!Array.isArray(t)||(t={}),Object.keys(r).forEach(function(a){"object"==typeof r[a]&&r[a]&&o.isPlainObject(r[a])?r[a]!=n&&(t[a]?e(t[a],r[a]):t[a]=e(null,r[a])):t[a]=r[a]})):t=r,t}(e,t)},o.clone=function(e){return o.deepmerge(null,e)},o.normalizeWheel=function(e){var t=0,n=0,r=0,o=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=10*t,o=10*n,"deltaY"in e&&(o=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||o)&&e.deltaMode&&(1===e.deltaMode?(r*=40,o*=40):(r*=800,o*=800)),r&&!t&&(t=r<1?-1:1),o&&!n&&(n=o<1?-1:1),{spinX:t,spinY:n,pixelX:r,pixelY:o}},o.forEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},o});
//# sourceMappingURL=sourcemaps/PSVUtils.js.map
