/**
 * skylark-sphere - A version of sphere that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-sphere/
 * @license MIT
 */
define(["../_psv/ctoc","../PSVUtils","./PSVComponent"],function(t,o,i){"use strict";function s(t){i.call(this,t),this.config=this.psv.config.tooltip,this.prop={timeout:null},this.create()}return s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.className="psv-tooltip",s.publicMethods=["showTooltip","hideTooltip","isTooltipVisible"],s.leftMap={0:"left",.5:"center",1:"right"},s.topMap={0:"top",.5:"center",1:"bottom"},s.prototype.create=function(){i.prototype.create.call(this),this.container.innerHTML='<div class="psv-tooltip-arrow"></div><div class="psv-tooltip-content"></div>',this.container.style.top="-1000px",this.container.style.left="-1000px",this.content=this.container.querySelector(".psv-tooltip-content"),this.arrow=this.container.querySelector(".psv-tooltip-arrow"),this.psv.on("render",this)},s.prototype.destroy=function(){this.psv.off("render",this),delete this.config,delete this.prop,i.prototype.destroy.call(this)},s.prototype.handleEvent=function(t){switch(t.type){case"render":this.hideTooltip()}},s.prototype.isTooltipVisible=function(){return this.container.classList.contains("psv-tooltip--visible")},s.prototype.showTooltip=function(t){this.prop.timeout&&(window.clearTimeout(this.prop.timeout),this.prop.timeout=null);var i=this.isTooltipVisible(),e=this.container,p=this.content,r=this.arrow;if(t.position||(t.position=["top","center"]),t.box||(t.box={width:0,height:0}),"string"==typeof t.position){var n=o.parsePosition(t.position);if(!(n.left in s.leftMap&&n.top in s.topMap))throw new PSVError('unable to parse tooltip position "'+t.position+'"');t.position=[s.topMap[n.top],s.leftMap[n.left]]}if("center"===t.position[0]&&"center"===t.position[1])throw new PSVError('unable to parse tooltip position "center center"');if(i)for(var l=e.classList.length-1;l>=0;l--){var h=e.classList.item(l);"psv-tooltip"!==h&&"psv-tooltip--visible"!==h&&e.classList.remove(h)}else e.className="psv-tooltip";t.className&&o.addClasses(e,t.className),p.innerHTML=t.content,e.style.top="0px",e.style.left="0px";var c=e.getBoundingClientRect(),a={posClass:t.position.slice(),width:c.right-c.left,height:c.bottom-c.top,top:0,left:0,arrow_top:0,arrow_left:0};this._computeTooltipPosition(a,t);var f=!1;a.top<this.config.offset?(a.posClass[0]="bottom",f=!0):a.top+a.height>this.psv.prop.size.height-this.config.offset&&(a.posClass[0]="top",f=!0),a.left<this.config.offset?(a.posClass[1]="right",f=!0):a.left+a.width>this.psv.prop.size.width-this.config.offset&&(a.posClass[1]="left",f=!0),f&&this._computeTooltipPosition(a,t),e.style.top=a.top+"px",e.style.left=a.left+"px",r.style.top=a.arrow_top+"px",r.style.left=a.arrow_left+"px",e.classList.add("psv-tooltip--"+a.posClass.join("-")),i||(this.prop.timeout=window.setTimeout(function(){e.classList.add("psv-tooltip--visible"),this.prop.timeout=null,this.psv.trigger("show-tooltip")}.bind(this),this.config.delay))},s.prototype.hideTooltip=function(){this.prop.timeout&&(window.clearTimeout(this.prop.timeout),this.prop.timeout=null),this.isTooltipVisible()&&(this.container.classList.remove("psv-tooltip--visible"),this.prop.timeout=window.setTimeout(function(){this.content.innerHTML=null,this.container.style.top="-1000px",this.container.style.left="-1000px",this.prop.timeout=null}.bind(this),this.config.delay),this.psv.trigger("hide-tooltip"))},s.prototype._computeTooltipPosition=function(t,o){var i=!1;switch(t.posClass[0]){case"bottom":t.top=o.top+o.box.height+this.config.offset+this.config.arrow_size,t.arrow_top=2*-this.config.arrow_size,i=!0;break;case"center":t.top=o.top+o.box.height/2-t.height/2,t.arrow_top=t.height/2-this.config.arrow_size;break;case"top":t.top=o.top-t.height-this.config.offset-this.config.arrow_size,t.arrow_top=t.height,i=!0}switch(t.posClass[1]){case"right":i?(t.left=o.left+o.box.width/2-this.config.offset-this.config.arrow_size,t.arrow_left=this.config.offset):(t.left=o.left+o.box.width+this.config.offset+this.config.arrow_size,t.arrow_left=2*-this.config.arrow_size);break;case"center":t.left=o.left+o.box.width/2-t.width/2,t.arrow_left=t.width/2-this.config.arrow_size;break;case"left":i?(t.left=o.left-t.width+o.box.width/2+this.config.offset+this.config.arrow_size,t.arrow_left=t.width-this.config.offset-2*this.config.arrow_size):(t.left=o.left-t.width-this.config.offset-this.config.arrow_size,t.arrow_left=t.width)}},s});
//# sourceMappingURL=../sourcemaps/components/PSVTooltip.js.map
